function(add_subdirectory_optional dir)
    if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/${dir}/CMakeLists.txt")
        add_subdirectory(${dir})
    endif()
endfunction()

function(target_include_directories_from_object target)
    foreach(object ${ARGN})
        get_target_property(INCLUDE_DIRS ${object} INTERFACE_INCLUDE_DIRECTORIES)
        if(NOT INCLUDE_DIRS STREQUAL INCLUDE_DIRS-NOTFOUND)
            target_include_directories(${target} PUBLIC ${INCLUDE_DIRS})
        endif()
    endforeach()
endfunction()

function(target_link_libraries_to_object target)
    foreach(object ${ARGN})
        get_target_property(INCLUDE_DIRS ${object} INTERFACE_INCLUDE_DIRECTORIES)
        if(NOT INCLUDE_DIRS STREQUAL INCLUDE_DIRS-NOTFOUND)
            target_include_directories(${target} PUBLIC ${INCLUDE_DIRS})
        endif()

        get_target_property(COMPILE_DEFS ${object} INTERFACE_COMPILE_DEFINITIONS)
        if(NOT COMPILE_DEFS STREQUAL COMPILE_DEFS-NOTFOUND)
            target_compile_definitions(${target} PUBLIC ${COMPILE_DEFS})
        endif()

        target_sources(${target} PRIVATE $<TARGET_OBJECTS:${object}>)
    endforeach()
endfunction()
